(()=>{var e={};e.id=758,e.ids=[758],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},79551:e=>{"use strict";e.exports=require("url")},74075:e=>{"use strict";e.exports=require("zlib")},77598:e=>{"use strict";e.exports=require("node:crypto")},32584:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>u,routeModule:()=>p,serverHooks:()=>g,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var n=r(42706),a=r(28203),o=r(45994),i=r(21031),c=e([i]);i=(c.then?(await c)():c)[0];let p=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"D:\\NextJS\\medical website\\medical-clinic\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:g}=p;function u(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}s()}catch(e){s(e)}})},96487:()=>{},78335:()=>{},21031:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{POST:()=>l});var n=r(39187),a=r(73401),o=r(16702),i=r(41581),c=r(14726),u=r(44512),p=e([i]);async function l(e){let{phone:t,password:r}=await e.json();n.NextResponse.next();let s=await (0,a.Nd)(await (0,u.UL)(),o.x);try{let e=await (0,i.m)({phone:t,password:r}),a=(0,c.s)(e.token);if(!e.success)return n.NextResponse.json({success:!1,message:"Login failed"},{status:401});try{s.user={token:e.token,userId:a.user_id||"",role:a.role||"",isLoggedIn:!0},await s.save()}catch(e){console.error("Error saving session:",e)}return n.NextResponse.json({success:!0,message:"Login successful",token:e.token})}catch(e){return console.error("Login API error:",e),n.NextResponse.json({success:!1,message:"Internal server error"},{status:500})}}i=(p.then?(await p)():p)[0],s()}catch(e){s(e)}})},54638:(e,t,r)=>{"use strict";r.d(t,{S:()=>n});var s=r(94499);let n=(0,s.J1)`
  mutation customerLogin($phone: String!, $password: String!) {
    customerLogin(phone: $phone, password: $password) {
      token
      message
    }
  }
`},73404:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{A:()=>l});var n=r(5819),a=r(27466),o=r(89981),i=r(17133),c=r.n(i),u=r(43327);let e=async()=>{let e=await (0,u.v)();return e?.token||null},p=await e(),l=new n.R({ssrMode:!0,link:new a.P({uri:"https://api.natsay.com.mm/v1/graphql",fetch:c(),headers:{...p?{Authorization:`Bearer ${p}`}:{}}}),cache:new o.D});s()}catch(e){s(e)}},1)},41581:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{m:()=>i});var n=r(54638),a=r(73404),o=e([a]);async function i({phone:e,password:t}){try{let{data:r}=await a.A.mutate({mutation:n.S,variables:{phone:e,password:t},fetchPolicy:"no-cache"}),s=r?.customerLogin||null;if(s)return{success:!0,message:s.message,token:s.token};return{success:!1,message:"Login failed."}}catch(e){return console.log("Login error:",e),{success:!1,message:"An error occurred during login."}}}a=(o.then?(await o)():o)[0],s()}catch(e){s(e)}})},16702:(e,t,r)=>{"use strict";r.d(t,{x:()=>s});let s={password:process.env.IRON_SESSION_PASSWORD,cookieName:"myapp_session",cookieOptions:{secure:!0,httpOnly:!0,sameSite:"lax",maxAge:1209600}}},43327:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a,v:()=>o});var s=r(13673),n=r(47317);function a(...e){return(0,n.QP)((0,s.$)(e))}let o=async()=>(console.log("Skipping session fetch during build time."),null)},14726:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});class s extends Error{}function n(e,t){let r;if("string"!=typeof e)throw new s("Invalid token specified: must be a string");t||(t={});let n=!0===t.header?0:1,a=e.split(".")[n];if("string"!=typeof a)throw new s(`Invalid token specified: missing part #${n+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(a)}catch(e){throw new s(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new s(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}s.prototype.name="InvalidTokenError"}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[989,337,452,178],()=>r(32584));module.exports=s})();